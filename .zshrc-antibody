source <(antibody init)

# zsh-completion-generator folder
export GENCOMPL_FPATH=~/dotfiles/completions

# zsh settings
export HISTFILE=/home/arsham/Dropbox/Home/.zsh_history
export HISTSIZE=999999999
export SAVEHIST=$HISTSIZE
export LANG=en_GB.UTF-8
export LC_CTYPE=en_GB.UTF8
export EDITOR=nano
export VISUAL=nano

# zsh functions
export fpath=(~/dotfiles/functions "${fpath[@]}")

. ~/dotfiles/zsh_conf/powerlevel9k.zsh-theme

# fix for oh-my-zsh tweaks that let's installing some plugins
ZSH="${HOME}/.cache/antibody/https-COLON--SLASH--SLASH-github.com-SLASH-robbyrussell-SLASH-oh-my-zsh"
DISABLE_AUTO_UPDATE=true

antibody bundle <<EOBUNDLES

    robbyrussell/oh-my-zsh
    tarruda/zsh-autosuggestions
    zsh-users/zsh-completions
    zsh-users/zsh-history-substring-search
    zsh-users/zsh-syntax-highlighting
    robbyrussell/oh-my-zsh folder:lib/key-bindings
    robbyrussell/oh-my-zsh folder:plugins/command-not-found
    robbyrussell/oh-my-zsh folder:plugins/RobSis/zsh-completion-generator
    robbyrussell/oh-my-zsh folder:plugins/emoji
    robbyrussell/oh-my-zsh folder:plugins/docker
    sorin-ionescu/prezto folder:modules/boot2docker
    sorin-ionescu/prezto folder:plugins/ssh-agent
    sorin-ionescu/prezto folder:plugins/completion
    robbyrussell/oh-my-zsh folder:plugins/golang
    sorin-ionescu/prezto folder:modules/colored-man-pages
    sorin-ionescu/prezto folder:plugins/z
    bhilburn/powerlevel9k
    robbyrussell/oh-my-zsh folder:plugins/git

EOBUNDLES

[ -f ~/.zshrc-local ] && source ~/.zshrc-local
[ -f ~/dotfiles/.zaliases ] && source ~/dotfiles/.zaliases

# fzf settings
. ~/dotfiles/zsh_conf/fzf

# history search
bindkey '^[[A' history-substring-search-up
bindkey '^[[B' history-substring-search-down

zstyle ':prezto:module:autosuggestions' color 'yes'

if [[ -d ~/dotfiles/functions ]]; then
   for func in $(find ~/dotfiles/functions -type f -exec realpath {} +); do
      unhash -f $func 2>/dev/null
      autoload +X $func
   done
fi

if [[ -d ~/dotfiles/widgets ]]; then
   for func in $(find ~/dotfiles/widgets -type f -exec realpath {} +); do
      source $func
   done
fi
